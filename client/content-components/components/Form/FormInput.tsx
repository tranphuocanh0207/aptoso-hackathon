import React from "react"
import { useController, type UseControllerProps } from "react-hook-form"
import { useBoolean } from "react-use"

import { cn } from "~utils/lib"

type FormInputProps = UseControllerProps & {
  prefix?: React.ReactNode
  suffix?: React.ReactNode
  placeholder?: string
} & React.InputHTMLAttributes<HTMLInputElement>

export const FormInput: React.FC<FormInputProps> = ({
  prefix,
  suffix,
  placeholder,
  type,
  className,
  ...controllerProps
}) => {
  const {
    field,
    fieldState: { error }
  } = useController(controllerProps)

  const [show, setShow] = useBoolean(false)

  return (
    <div className="mb-4 flex flex-col gap-0.5">
      <div className="w-full relative flex items-center">
        {prefix}
        <input
          placeholder={placeholder}
          type={type === "password" ? (show ? "text" : "password") : type}
          className={cn(
            `px-3 py-2 border-[1px] h-[52px] border-[#272930] placeholder:text-[#3D3F46] duration-200 focus:ring-[#23F7DD] focus:outline-none rounded-2xl w-full`,
            className
          )}
          {...field}
        />
        {suffix}
        {type === "password" && (
          <button
            onClick={(e) => {
              e.stopPropagation()
              setShow()
            }}
            className="btn bg-transparent border-none shadow-none absolute top-[15px] right-3">
            {show ? IconEyeSlash : IconEye}
          </button>
        )}
      </div>
      {error && <p className="text-red text-sm mt-1 ml-1">{error.message}</p>}
    </div>
  )
}

export const IconEye = (
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <path
      d="M12 15C12.7956 15 13.5587 14.6839 14.1213 14.1213C14.6839 13.5587 15 12.7956 15 12C15 11.2044 14.6839 10.4413 14.1213 9.87868C13.5587 9.31607 12.7956 9 12 9C11.2044 9 10.4413 9.31607 9.87868 9.87868C9.31607 10.4413 9 11.2044 9 12C9 12.7956 9.31607 13.5587 9.87868 14.1213C10.4413 14.6839 11.2044 15 12 15Z"
      fill="#6A6C73"
    />
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M1.32308 11.447C2.81108 6.976 7.02808 3.75 12.0011 3.75C16.9711 3.75 21.1861 6.973 22.6761 11.44C22.7961 11.802 22.7961 12.192 22.6761 12.553C21.1891 17.024 16.9711 20.25 11.9991 20.25C7.02908 20.25 2.81308 17.027 1.32408 12.56C1.20382 12.1987 1.20382 11.8083 1.32408 11.447H1.32308ZM17.2501 12C17.2501 13.3924 16.697 14.7277 15.7124 15.7123C14.7278 16.6969 13.3925 17.25 12.0001 17.25C10.6077 17.25 9.27233 16.6969 8.28777 15.7123C7.3032 14.7277 6.75008 13.3924 6.75008 12C6.75008 10.6076 7.3032 9.27225 8.28777 8.28769C9.27233 7.30312 10.6077 6.75 12.0001 6.75C13.3925 6.75 14.7278 7.30312 15.7124 8.28769C16.697 9.27225 17.2501 10.6076 17.2501 12Z"
      fill="#6A6C73"
    />
  </svg>
)

const IconEyeSlash = (
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <path
      d="M3.52985 2.46997C3.38767 2.33749 3.19963 2.26537 3.00532 2.26879C2.81102 2.27222 2.62564 2.35093 2.48822 2.48835C2.35081 2.62576 2.2721 2.81114 2.26867 3.00545C2.26524 3.19975 2.33737 3.38779 2.46985 3.52997L20.4698 21.53C20.5385 21.6037 20.6213 21.6628 20.7133 21.7038C20.8053 21.7447 20.9046 21.7668 21.0053 21.7686C21.106 21.7703 21.2061 21.7518 21.2994 21.7141C21.3928 21.6764 21.4777 21.6202 21.5489 21.549C21.6201 21.4778 21.6762 21.393 21.714 21.2996C21.7517 21.2062 21.7702 21.1061 21.7684 21.0054C21.7667 20.9047 21.7446 20.8054 21.7036 20.7134C21.6626 20.6214 21.6035 20.5386 21.5298 20.47L3.52985 2.46997ZM22.6758 12.553C22.1368 14.1705 21.2371 15.6442 20.0448 16.863L16.9458 13.764C17.2802 12.8279 17.3419 11.8161 17.1239 10.8463C16.9058 9.87657 16.4169 8.98861 15.7141 8.28575C15.0112 7.58289 14.1232 7.09401 13.1535 6.87595C12.1837 6.65789 11.1719 6.71963 10.2358 7.05397L7.75885 4.57697C9.10587 4.02893 10.5466 3.74805 12.0008 3.74997C16.9708 3.74997 21.1858 6.97297 22.6758 11.44C22.7958 11.802 22.7958 12.192 22.6758 12.553Z"
      fill="#F6F8FF"
    />
    <path
      d="M15.7498 12.0001C15.7498 12.1801 15.7368 12.3571 15.7128 12.5301L11.4688 8.28705C12.0008 8.21096 12.5429 8.25009 13.0584 8.4018C13.574 8.5535 14.0509 8.81424 14.4568 9.16635C14.8628 9.51846 15.1884 9.95371 15.4114 10.4426C15.6345 10.9315 15.7499 11.4627 15.7498 12.0001ZM12.5298 15.7131L8.28679 11.4691C8.20435 12.0455 8.2573 12.6333 8.44144 13.1857C8.62558 13.7382 8.93586 14.2402 9.34769 14.6519C9.75951 15.0636 10.2616 15.3738 10.8141 15.5578C11.3666 15.7418 11.9543 15.7946 12.5308 15.7121L12.5298 15.7131Z"
      fill="#F6F8FF"
    />
    <path
      d="M6.74989 12C6.74989 11.381 6.85689 10.787 7.05389 10.236L3.95389 7.13599C2.76199 8.35483 1.86267 9.82861 1.32389 11.446C1.20389 11.808 1.20389 12.198 1.32389 12.56C2.81289 17.027 7.02789 20.25 11.9989 20.25C13.4989 20.25 14.9319 19.956 16.2409 19.423L13.7639 16.946C12.9715 17.2286 12.1229 17.3168 11.2893 17.2029C10.4558 17.0891 9.66188 16.7766 8.97437 16.2917C8.28685 15.8069 7.72591 15.164 7.33878 14.4171C6.95166 13.6702 6.74969 12.8412 6.74989 12Z"
      fill="#F6F8FF"
    />
  </svg>
)
